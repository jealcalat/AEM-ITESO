<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2. Modelos de distribución multivariados</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="2.1_funciones_distribucion_densidad_files/libs/clipboard/clipboard.min.js"></script>
<script src="2.1_funciones_distribucion_densidad_files/libs/quarto-html/quarto.js"></script>
<script src="2.1_funciones_distribucion_densidad_files/libs/quarto-html/popper.min.js"></script>
<script src="2.1_funciones_distribucion_densidad_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2.1_funciones_distribucion_densidad_files/libs/quarto-html/anchor.min.js"></script>
<link href="2.1_funciones_distribucion_densidad_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2.1_funciones_distribucion_densidad_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2.1_funciones_distribucion_densidad_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2.1_funciones_distribucion_densidad_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2.1_funciones_distribucion_densidad_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">2. Modelos de distribución multivariados</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="funciones-de-distribución-y-densidad" class="level2">
<h2 class="anchored" data-anchor-id="funciones-de-distribución-y-densidad">2.1. Funciones de distribución y densidad</h2>
<p align="right">
Autor: Emmanuel Alcalá <br> <a href="https://scholar.google.com.mx/citations?hl=en&amp;user=3URusCgAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Google Scholar</a>
</p>
<!-- <p align="left">
<br>
<a href="https://jealcalat.github.io/Analisis_multivariado/">Regresar a la página del curso</a>
</p> -->
<hr>
<section id="variables-aleatorias-espacios-muestrales-y-realizaciones" class="level3">
<h3 class="anchored" data-anchor-id="variables-aleatorias-espacios-muestrales-y-realizaciones">Variables aleatorias, espacios muestrales y realizaciones</h3>
<p>Suponer que <span class="math inline">\(X\)</span> representa una cantidad desconocida de interés, como la temperatura de una máquina. Si los valores de <span class="math inline">\(X\)</span> son desconocidos o cambian, decimos que <span class="math inline">\(X\)</span> es una variable aleatoria, o <strong>VA</strong>. El conjunto de todos los valores <em>posibles</em> se denota como <span class="math inline">\(\mathcal{X}\)</span>, llamado espacio muestral o espacio de estados. Un evento es un <em>sub</em>conjunto de valores del espacio muestral. Por ejemplo, si <span class="math inline">\(\mathcal{X}\)</span> es el lado de un dado al ser lanzado, <span class="math inline">\(\mathcal{X} = \{ 1, 2, 3, 4, 5, 6 \}\)</span>, el evento “cae 1” se denota <span class="math inline">\(X = 1\)</span>, y “ver un número impar” se denota <span class="math inline">\(X \in \{ 1, 3, 4\}\)</span>, el evento “cae entre 4 y 6” como <span class="math inline">\(4 \leq X \leq 6\)</span>.</p>
<p>Vamos a enlazar todos los conceptos:</p>
<p><strong>Variable Aleatoria <span class="math inline">\(X\)</span></strong></p>
<p>Pensemos en <span class="math inline">\(X\)</span> como la temperatura de un horno. Aquí, <span class="math inline">\(X\)</span> no es un valor de temperatura específico. En cambio, es una “regla” que nos dice cómo interpretar las mediciones de temperatura que podríamos obtener del horno. Técnicamente, una variable aleatoria es una función que asigna un número real a cada resultado en el espacio muestral. En este caso específico, la función es una función de identidad, lo que significa que <span class="math inline">\(X\)</span> asigna el mismo valor a cada resultado en el espacio muestral. Lo anterior podríamos describirlo como <span class="math inline">\(X: \mathcal{X} \rightarrow \mathbb{R}\)</span>, o como <span class="math inline">\(X(\omega) = \omega\)</span> para todo <span class="math inline">\(\omega \in \mathcal{X}\)</span>, en donde <span class="math inline">\(\omega\)</span> es un resultado en el espacio muestral.</p>
<p>Una variable aleatoria más compleja puede ser el índice de masa corporal. El Índice de Masa Corporal (BMI, por sus siglas en inglés) es una medida comúnmente utilizada para evaluar la proporción de peso a estatura de un individuo. El BMI se calcula mediante la fórmula:</p>
<p><span class="math display">\[
\text{BMI} = \frac{{\text{peso en kg}}}{{(\text{altura en m})^2}}
\]</span></p>
<p>En el contexto de la teoría de la probabilidad, podemos considerar el BMI como una Variable Aleatoria <span class="math inline">\(X\)</span> que es una función del peso y la altura de un individuo.</p>
<p>La Variable Aleatoria <span class="math inline">\(X\)</span> asignaría a cada par <span class="math inline">\((w, h)\)</span> en el espacio muestral un valor del BMI calculado mediante la fórmula mencionada:</p>
<p><span class="math display">\[
X(w, h) = \frac{w}{h^2}
\]</span></p>
<p><strong>Espacio Muestral <span class="math inline">\(\mathcal{X}\)</span></strong></p>
<p>Para el ejemplo del horno, el espacio muestral <span class="math inline">\(\mathcal{X}\)</span> podría ser todos los valores que la temperatura del horno podría tomar en una escala específica, digamos, de 100 a 250 grados Celsius: <span class="math inline">\(X={100,101,102,…,250}\)</span>.</p>
<p>Para el ejemplo del BMI, el espacio muestral <span class="math inline">\(\mathcal{X}\)</span> podría ser el conjunto de todas las posibles combinaciones de peso y altura para un grupo de individuos. Por ejemplo:</p>
<p><span class="math display">\[
\mathcal{X} = \{ (w, h) | 40 \leq w \leq 200, 1.2 \leq h \leq 2.5 \}
\]</span></p>
<p><strong>Realización <span class="math inline">\(x\)</span></strong></p>
<p>Si tomas una lectura real del termómetro en un momento específico y muestra, digamos, 180 grados Celsius, esa medida es una “realización” <span class="math inline">\(x\)</span> de la Variable Aleatoria <span class="math inline">\(X\)</span>.</p>
<p>Para el BMI, una realización <span class="math inline">\(x\)</span> de <span class="math inline">\(X\)</span> sería el BMI específico calculado para una combinación particular de peso y altura. Por ejemplo, si alguien tiene un peso de 70 kg y una altura de 1.75 m, la realización sería <span class="math inline">\(x = X(70, 1.75) = 22.86\)</span>.</p>
<p><strong>Eventos</strong></p>
<p>Un “evento” es un subconjunto específico de posibles temperaturas que podríamos encontrar interesantes. Por ejemplo:</p>
<ol type="1">
<li>El evento “El horno está por debajo de 150 grados” se denotaría como <span class="math inline">\(X&lt;150\)</span>.</li>
<li>El evento “El horno está a una temperatura ideal para hornear pan, entre 175 y 200 grados” podría denotarse como <span class="math inline">\(175\leq X \leq 200\)</span>.</li>
<li>El evento “tener sobrepeso”, que se podría definir como <span class="math inline">\(X(w, h) \geq 25\)</span>.</li>
</ol>
<p>Nota: generalmente, no se hace distinción entre una variable aleatoria y su realización. Por ejemplo, <span class="math inline">\(X\)</span> y <span class="math inline">\(x\)</span> se usan indistintamente para denotar la realización de una variable aleatoria. Así, aunque técnicamente deberíamos denotar la probabilidad de que el horno esté por debajo de 150 grados como <span class="math inline">\(P(X&lt;150)\)</span>, en la práctica, a menudo escribimos <span class="math inline">\(P(x&lt;150)\)</span>.</p>
</section>
<section id="definición-de-probabilidad" class="level3">
<h3 class="anchored" data-anchor-id="definición-de-probabilidad">Definición de probabilidad</h3>
<p><strong>¿Qué es una probabilidad?</strong></p>
<p><strong>Definición:</strong> La probabilidad es una medida que describe la posibilidad de que ocurra un evento en relación con la totalidad de posibles eventos. Se expresa numéricamente entre 0 y 1, donde 0 indica imposibilidad y 1 indica certeza.</p>
<p><strong>Matemáticamente:</strong> Sea $ S $ un espacio muestral, es decir, el conjunto de todos los posibles resultados de un experimento, y $ A $ un evento específico que pertenece a $ S $. La probabilidad $ P(A) $ de que ocurra $ A $ se define como:</p>
<p><span class="math display">\[ P(A) = \frac{\text{número de casos favorables para } A}{\text{número total de casos en } S} \]</span></p>
<p>Algunas propiedades de las <span class="math inline">\(P()\)</span> son:</p>
<ol type="1">
<li>Si <span class="math inline">\(\emptyset\)</span> es un conjunto nulo, entonces <span class="math inline">\(\Pr(\emptyset)=0\)</span>.</li>
<li>Si <span class="math inline">\(A \subset B\)</span>, entonces <span class="math inline">\(\Pr(A)\leq \Pr(B)\)</span>.</li>
<li>Si <span class="math inline">\(A^c\)</span> denota el complemento de <span class="math inline">\(A\)</span>, entonces <span class="math inline">\(\Pr(A^c)=1-\Pr(A)\)</span>.</li>
<li>Si <span class="math inline">\(A \cap B = \emptyset\)</span> denota la intersección nula de <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span>, entonces <span class="math inline">\(\Pr(A \cup B)=\Pr(A) + \Pr(B)\)</span>, <span class="math inline">\(\Pr\)</span> es aditiva para eventos disjuntos.</li>
<li>De otra manera, para eventos arbitrarios <span class="math inline">\(A, B\)</span>, <span class="math inline">\(\Pr(A \cup B)=\Pr(A) + \Pr(B)-\Pr(A\cap B)\)</span>.</li>
<li>Dos eventos <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> son independientes si <span class="math inline">\(\Pr(A \cup B)=\Pr(A)\Pr(B)\)</span>. Por ejemplo, lanzar una moneda dos veces. Cada lanzamiento es independiente del otro. Si queremos saber la probabilidad de que en ambos lanzamientos salga caras, esa probabilidad sería <span class="math inline">\(\Pr(H_1\cap H_2)=(1/2)(1/2)\)</span>.</li>
</ol>
</section>
<section id="probabilidades-empíricas" class="level3">
<h3 class="anchored" data-anchor-id="probabilidades-empíricas">Probabilidades empíricas</h3>
<p>Podemos ilustrar varios conceptos de probabilidad utilizando un arreglo en dos dimensiones. Por ejemplo, en la siguiente imagen (adaptado de MML-6.2)</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, HTML</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>image_path <span class="op">=</span>  <span class="st">"img/joint_dist_tikz.png"</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>display(HTML(<span class="st">'&lt;div style="text-align: center;"&gt;&lt;img src="</span><span class="sc">{}</span><span class="st">" width="30%"/&gt;&lt;/div&gt;'</span>.<span class="bu">format</span>(image_path)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div style="text-align: center;"><img src="img/joint_dist_tikz.png" width="30%"></div>
</div>
</div>
<p>muestra dos variables aleatorias bivariadas, <span class="math inline">\(X\)</span> (que puede tomar valores <span class="math inline">\(x_j, j = 1, 2, \dots, M\)</span>) y <span class="math inline">\(Y\)</span> (que puede tomar valores <span class="math inline">\(i=1, 2, \dots, L\)</span>).</p>
<ul>
<li><span class="math inline">\(c_j\)</span>: conteo marginal en <span class="math inline">\(x_j\)</span></li>
<li><span class="math inline">\(r_i\)</span>: conteo marginal en <span class="math inline">\(y_i\)</span></li>
<li><span class="math inline">\(n_{ij}\)</span>: casos en la celda <span class="math inline">\(x_j, y_i\)</span></li>
</ul>
<p>La probabilidad (<em>conjunta</em>) de que <span class="math inline">\(X=x, Y=y\)</span> se define como</p>
<p><span class="math display">\[
  p(x, y) \overset{\Delta}{=} \text{Pr}(X = x, Y = y)
\]</span></p>
<p><span class="math inline">\(p(x, y)\)</span> se lee “la probabilidad de <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span>”, en ocasiones escrito usando notación de teoría de conjuntos como <span class="math inline">\(p(x \cap y)\)</span>. Cada entrada (cada celda) en la tabla se calcula contando la cantidad de casos que <span class="math inline">\((x_j,y_i)\)</span> suceden conjuntamente</p>
<p><span class="math display">\[
\text{Pr}(X = x_j, Y = y_i) = \frac{n_{ij}}{N} \tag{1}
\]</span></p>
<p>En la tabla, si contamos todos los casos de la fila <span class="math inline">\(i\)</span> tenemos la cantidad total de veces que <span class="math inline">\(y_i\)</span> sucede, y lo llamamos <span class="math inline">\(r_i\)</span>. Si contamos la columna <span class="math inline">\(j\)</span> tenemos la cantidad total de veces que <span class="math inline">\(x_j\)</span> sucede, y que llamamos <span class="math inline">\(c_j\)</span>.</p>
<p>La <em>probabilidad marginal</em> de <span class="math inline">\(x\)</span>, es decir, la probabilidad que <span class="math inline">\(X=x\)</span> sin importar el valor de <span class="math inline">\(Y\)</span> se escribe como <span class="math inline">\(p(x)\)</span> y se calcula como sigue</p>
<p><span class="math display">\[
  p(X = x_j) = p(x_j) = \frac{c_j}{N} \tag{2}
\]</span></p>
<p>El número de casos en la columna <span class="math inline">\(j\)</span> es la suma de casos en cada celda <em>en esa columna</em>, por lo que <span class="math inline">\(c_j = \sum_i n_{ij}\)</span> (dejando fija <span class="math inline">\(i\)</span>). Por lo tanto,</p>
<p><span class="math display">\[
  p(x_j) = \sum_{i=1}^Lp(x_j, y_i) \tag{3}
\]</span></p>
<p>A la ecuación (3) se le conoce como la <em>regla de la suma</em>. Notar que se fija la columna <span class="math inline">\(j\)</span> y se itera sobre las filas <span class="math inline">\(i=1, 2, 3\)</span>, por lo que por cada columna <span class="math inline">\(j\)</span> tenemos una probabilidad <span class="math inline">\(p(x_j)\)</span>, que llamamos <em>la distribución marginal</em> de <span class="math inline">\(x\)</span>.</p>
<p>Si consideramos los casos en los que <span class="math inline">\(X=x_j\)</span>, la <em>fracción</em> de casos en los que <span class="math inline">\(Y=y_i\)</span> se escribe como <span class="math inline">\(p(Y=y_i | X=x_j)\)</span>, probabilidad que es conocida como <em>probabilidad condicional</em> de <span class="math inline">\(Y=y_i\)</span> <em>dado</em> que <span class="math inline">\(X=x_j\)</span>. Se obtiene encontrando la fracción de puntos en una columna <span class="math inline">\(j\)</span> que caen en una celda <span class="math inline">\((i,j)\)</span> dada</p>
<p><span class="math display">\[
  p(y_i | x_j) = \frac{n_{ij}}{c_j} \tag{4}
\]</span></p>
<p>Notar que <span class="math inline">\(c_j\)</span> es la cantidad total de valores para los cuales <span class="math inline">\(X=x_j\)</span>, y <span class="math inline">\(n_{ij}\)</span> es una celda particular. Con las ecuaciones (1), (2) y (4) podemos derivar la siguiente relación:</p>
<p><span class="math display">\[\begin{align*}
p(x_j, y_i) &amp;= \frac{n_{ij}}{N} = \frac{n_{ij}}{c_j} \frac{c_j}{N}\\
&amp;= p(y_i | x_j)p(x_j) \tag{5}
\end{align*}\]</span></p>
<p>La ecuación (5) es conocida como <em>regla del producto</em>.</p>
<p>Eliminando la notación excesiva, podemos sintetizar las dos reglas como sigue</p>
<p><span class="math display">\[\begin{align*}
\text{ \textbf{regla de la suma}}\quad\quad &amp;p(x) = \sum_{y}p(x,y) \\
\text{ \textbf{regla del producto}}\quad\quad &amp;p(x, y) = p(y|x)p(x)
\end{align*}\]</span></p>
<p>Considerando la simetría <span class="math inline">\(p(x,y) = p(y,x)\)</span> y que <span class="math inline">\(p(y,x) = p(x|y)p(y)\)</span>, encontramos la siguiente relación</p>
<p><span class="math display">\[\begin{align*}
p(y|x)p(x) &amp;= p(x|y)p(y)\\
p(y|x) &amp;= \frac{ p(x|y)p(y)}{p(x)}\tag{6}
\end{align*}\]</span></p>
<p>Con</p>
<p><span class="math display">\[\begin{align*}
1.  &amp; f(x, y) \geq 0\\
2.  &amp; \sum_{x,y}f(x, y) = 1
\end{align*}\]</span></p>
<p>La ecuación (6) es llamada <em>Teorema de Bayes</em>, y tiene una importancia en ML y estadística que no puede ser exagerada.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, HTML</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear distribución conjunta {X,Y}</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'Y'</span>: np.tile(np.arange(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dv">3</span>), </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'X'</span>: np.repeat(np.arange(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dv">4</span>)}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>data_for_sampling <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>data_for_sampling[<span class="st">'wgts'</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">0</span>]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomar una muestra aleatoria de la distribución conjunta X,Y, usando wgts como pesos</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">452</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>sampled_data <span class="op">=</span> data_for_sampling.sample(n<span class="op">=</span><span class="dv">10000</span>, replace<span class="op">=</span><span class="va">True</span>, weights<span class="op">=</span><span class="st">'wgts'</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una tabla de frecuencia</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>freq_table <span class="op">=</span> pd.crosstab(sampled_data[<span class="st">'Y'</span>], sampled_data[<span class="st">'X'</span>], rownames<span class="op">=</span>[<span class="st">'Y/X'</span>])</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla en formato HTML</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>display(HTML(tabulate(freq_table, headers<span class="op">=</span><span class="st">'keys'</span>, tablefmt<span class="op">=</span><span class="st">'html'</span>)))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># X en las columnas, Y en las filas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Y/X</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">275</td>
<td style="text-align: right;">416</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">446</td>
<td style="text-align: right;">2570</td>
<td style="text-align: right;">1338</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1251</td>
<td style="text-align: right;">2523</td>
<td style="text-align: right;">396</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">462</td>
<td style="text-align: right;">323</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>freq_table.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>Y/X
0     691
1    4354
2    4170
3     785
dtype: int64</code></pre>
</div>
</div>
</section>
</section>
<section id="ejercicios-a-mano" class="level2">
<h2 class="anchored" data-anchor-id="ejercicios-a-mano">Ejercicios a mano</h2>
<ol type="1">
<li>La segunda tabla muestra la tabla de frecuencias de la muestra total, ¿cuál es la probabilidad <span class="math inline">\(p(y=0, x=1)\)</span>?</li>
<li>¿Cuál es la probabilidad <span class="math inline">\(p(x=1 \mid y=0)\)</span>?</li>
<li>Encontrar <span class="math inline">\(F(X\leq 1,Y\leq 2)\)</span></li>
</ol>
<p>Para el ejercicio 2</p>
<div class="cell" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener la distribución conjunta de cada celda</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>xt_prob <span class="op">=</span> freq_table <span class="op">/</span> freq_table.<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> highlight_cells(x, row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(<span class="st">''</span>, index<span class="op">=</span>x.index, columns<span class="op">=</span>x.columns)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    df.loc[row, col] <span class="op">=</span> <span class="st">'background-color: red; color: black'</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>styled_table <span class="op">=</span> xt_prob.style.<span class="bu">apply</span>(highlight_cells, axis<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>display(styled_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_66cb8_row0_col1 {
  background-color: red;
  color: black;
}
</style>

<table id="T_66cb8" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th">X</th>
<th id="T_66cb8_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">0</th>
<th id="T_66cb8_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">1</th>
<th id="T_66cb8_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">2</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">Y/X</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_66cb8_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_66cb8_row0_col0" class="data row0 col0">0.000000</td>
<td id="T_66cb8_row0_col1" class="data row0 col1">0.027500</td>
<td id="T_66cb8_row0_col2" class="data row0 col2">0.041600</td>
</tr>
<tr class="even">
<td id="T_66cb8_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_66cb8_row1_col0" class="data row1 col0">0.044600</td>
<td id="T_66cb8_row1_col1" class="data row1 col1">0.257000</td>
<td id="T_66cb8_row1_col2" class="data row1 col2">0.133800</td>
</tr>
<tr class="odd">
<td id="T_66cb8_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_66cb8_row2_col0" class="data row2 col0">0.125100</td>
<td id="T_66cb8_row2_col1" class="data row2 col1">0.252300</td>
<td id="T_66cb8_row2_col2" class="data row2 col2">0.039600</td>
</tr>
<tr class="even">
<td id="T_66cb8_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_66cb8_row3_col0" class="data row3 col0">0.046200</td>
<td id="T_66cb8_row3_col1" class="data row3 col1">0.032300</td>
<td id="T_66cb8_row3_col2" class="data row3 col2">0.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>La celda en rojo corresponde a la probabilidad</p>
<p><span class="math display">\[
  p(y=0, x=1) = \frac{325}{10000}
\]</span></p>
<p>Para el ejercicio 3</p>
<p>Ahora, para calcular la probabilidad condicional <span class="math inline">\(p(x=1|y=0)\)</span> debemos obtener la probabilidad marginal de <span class="math inline">\(y\)</span>, o <span class="math inline">\(p(y=0)\)</span>.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate row sums</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>row_sums <span class="op">=</span> freq_table.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate p(y)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>xt_py <span class="op">=</span> freq_table.copy()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>xt_py[<span class="st">'p(y)'</span>] <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span>row_sum<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>freq_table<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">=</span><span class="sc">{</span>row_sum<span class="op">/</span>freq_table<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.4f}</span><span class="ss">"</span> <span class="cf">for</span> row_sum <span class="kw">in</span> row_sums]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Style the table</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> highlight_column(x):</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(<span class="st">''</span>, index<span class="op">=</span>x.index, columns<span class="op">=</span>x.columns)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'p(y)'</span>] <span class="op">=</span> <span class="st">'background-color: #d4d1d1; color: black'</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>styled_table <span class="op">=</span> xt_py.style.<span class="bu">apply</span>(highlight_column, axis<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>display(styled_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_05343_row0_col3, #T_05343_row1_col3, #T_05343_row2_col3, #T_05343_row3_col3 {
  background-color: #d4d1d1;
  color: black;
}
</style>

<table id="T_05343" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th">X</th>
<th id="T_05343_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">0</th>
<th id="T_05343_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">1</th>
<th id="T_05343_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">2</th>
<th id="T_05343_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">p(y)</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">Y/X</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_05343_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_05343_row0_col0" class="data row0 col0">0</td>
<td id="T_05343_row0_col1" class="data row0 col1">275</td>
<td id="T_05343_row0_col2" class="data row0 col2">416</td>
<td id="T_05343_row0_col3" class="data row0 col3">691/10000=0.0691</td>
</tr>
<tr class="even">
<td id="T_05343_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_05343_row1_col0" class="data row1 col0">446</td>
<td id="T_05343_row1_col1" class="data row1 col1">2570</td>
<td id="T_05343_row1_col2" class="data row1 col2">1338</td>
<td id="T_05343_row1_col3" class="data row1 col3">4354/10000=0.4354</td>
</tr>
<tr class="odd">
<td id="T_05343_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_05343_row2_col0" class="data row2 col0">1251</td>
<td id="T_05343_row2_col1" class="data row2 col1">2523</td>
<td id="T_05343_row2_col2" class="data row2 col2">396</td>
<td id="T_05343_row2_col3" class="data row2 col3">4170/10000=0.4170</td>
</tr>
<tr class="even">
<td id="T_05343_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_05343_row3_col0" class="data row3 col0">462</td>
<td id="T_05343_row3_col1" class="data row3 col1">323</td>
<td id="T_05343_row3_col2" class="data row3 col2">0</td>
<td id="T_05343_row3_col3" class="data row3 col3">785/10000=0.0785</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Luego, la probabilidad condicional será la probabilidad conjunta <span class="math inline">\(p(y=0, x=1)\)</span> dividida por la probabilidad marginal <span class="math inline">\(p(y=0)\)</span></p>
<p><span class="math display">\[
  p(x=1|y=0) = \frac{p(y=0,x=1)}{p(y=0)} = \frac{325/10000}{725/10000} = \frac{13}{29}
\]</span></p>
<p>En general, la distribución condicional <span class="math inline">\(p(x | y=0)\)</span> se puede obtener como sigue</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where Y == 0</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> sampled_data[sampled_data[<span class="st">'Y'</span>] <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count occurrences of each X value</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>count_data <span class="op">=</span> filtered_data[<span class="st">'X'</span>].value_counts().reset_index()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>count_data.columns <span class="op">=</span> [<span class="st">'X'</span>, <span class="st">'n'</span>]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the conditional probability p(x|y=0)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>count_data[<span class="st">'p(x|y=0)'</span>] <span class="op">=</span> count_data[<span class="st">'n'</span>] <span class="op">/</span> count_data[<span class="st">'n'</span>].<span class="bu">sum</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table (you can further style this table if you'd like)</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>display(HTML(tabulate(count_data, headers<span class="op">=</span><span class="st">'keys'</span>, tablefmt<span class="op">=</span><span class="st">'html'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">X</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p(x|y=0)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">416</td>
<td style="text-align: right;">0.602026</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">275</td>
<td style="text-align: right;">0.397974</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Para el ejercicio 4.</p>
<p><span class="math inline">\(F(X\leq 1,Y\leq 2) = p(x=0, y=0)+p(x=0, y=1)+p(x=0, y=2)+p(x=1, y=0)+p(x=1, y=1)+p(x=1, y=2)=\)</span></p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pivot table</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> pd.pivot_table(sampled_data, values<span class="op">=</span><span class="va">None</span>, index<span class="op">=</span><span class="st">'Y'</span>, columns<span class="op">=</span><span class="st">'X'</span>, aggfunc<span class="op">=</span><span class="st">'size'</span>, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize to get probabilities</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>xt_prob <span class="op">=</span> xt <span class="op">/</span> xt.values.<span class="bu">sum</span>()</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>display(HTML(xt_prob.to_html()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">X</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0000</td>
<td>0.0275</td>
<td>0.0416</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.0446</td>
<td>0.2570</td>
<td>0.1338</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.1251</td>
<td>0.2523</td>
<td>0.0396</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.0462</td>
<td>0.0323</td>
<td>0.0000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>La distribución condicional de <span class="math inline">\(x|y=y\)</span> puede verse totalmente diferente que la distribución marginal <span class="math inline">\(p(x)\)</span>. En la siguiente imagen, tomada de Bishop (PRML-1.1), se ilustra la distribución de dos variables <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span>. <span class="math inline">\(X\)</span> puede tomar 9 valores posibles, y <span class="math inline">\(Y\)</span> 2. La distribución marginal de <span class="math inline">\(X\)</span>, la distribución independientemente de qué valores tome <span class="math inline">\(Y\)</span>, tiene una forma más achatada (más amplia, con mayor varianza) que la distribución condicional a <span class="math inline">\(Y=1\)</span>.</p>
<p align="center">
<img src="img/marginal_conditional.png" width="40%">
</p>
<section id="definición-de-funciones-de-masa-de-probabilidad-pmf" class="level3">
<h3 class="anchored" data-anchor-id="definición-de-funciones-de-masa-de-probabilidad-pmf">Definición de Funciones de Masa de Probabilidad (PMF)</h3>
<p>Si <span class="math inline">\(\mathcal{X}\)</span> es finito o contable infinito (cada miembro de <span class="math inline">\(\mathcal{X}\)</span> puede asociarse con un elemento de <span class="math inline">\(\mathbb{N}\)</span>), entonces <span class="math inline">\(X\)</span> es una variable aleatoria <em>discreta</em>. Una función de masa de probabilidad (PMF, por sus siglas en inglés) es una función que describe la probabilidad de que una variable aleatoria discreta tome un valor específico. En otras palabras, para cada posible resultado en el espacio de muestras, la PMF asigna una probabilidad.</p>
<p>Matemáticamente, la PMF $ P(X = x) $ es una función que satisface las siguientes condiciones:</p>
<ol type="1">
<li><strong>Positividad</strong>: $ P(X = x) $ para todo $ x $.</li>
<li><strong>Normalización</strong>: $ _{x } P(X = x) = 1 $, donde $ $ es el espacio de muestras.</li>
</ol>
</section>
<section id="definición-de-funciones-de-densidad-de-probabilidad-pdf" class="level3">
<h3 class="anchored" data-anchor-id="definición-de-funciones-de-densidad-de-probabilidad-pdf">Definición de Funciones de Densidad de Probabilidad (PDF)</h3>
<p>Si <span class="math inline">\(X\in \mathbb{R}\)</span> es una función real, se denomina <em>variable aleatoria continua</em>, y es más natural especificar que <span class="math inline">\(X\)</span> se encuentre en un intervalo, e.g,, <span class="math inline">\(a \leq X \leq b\)</span>, dado que en este caso no se puede crear un conjunto <em>contable</em> de valores posibles que <span class="math inline">\(X\)</span> puede tomar, pero podemos crear un conjunto finito de <em>intervalos</em> en la linea real, y asociar los eventos de <span class="math inline">\(X\)</span> que están en esos intervalos.</p>
<p>Si el conjunto de posibles valores que una variable aleatoria $ X $ puede tomar es un intervalo (o una unión de intervalos) en la recta real, entonces $ X $ es una variable aleatoria <em>continua</em>. Una función de densidad de probabilidad (PDF, por sus siglas en inglés) es una función que describe cómo se distribuyen las probabilidades a lo largo de los posibles valores de una variable aleatoria continua. A diferencia de una PMF, donde se asigna una probabilidad directamente a un valor específico, la PDF asigna una densidad. Para obtener una probabilidad real de que $ X $ caiga en un intervalo específico, se integra la PDF sobre ese intervalo.</p>
<p>Matemáticamente, la PDF $ f(x) $ de una variable aleatoria continua $ X $ satisface las siguientes condiciones:</p>
<ol type="1">
<li><strong>No Negatividad</strong>: $ f(x) $ para todo $ x $.</li>
<li><strong>Normalización</strong>: $ _{-}^{} f(x) , dx = 1 $. Esto significa que el área total bajo la curva de la PDF (desde el infinito negativo hasta el infinito positivo) es 1.</li>
<li><strong>Probabilidad en un intervalo</strong>: La probabilidad de que $ X $ esté en el intervalo $ [a, b] $ es $ _{a}^{b} f(x) , dx $.</li>
</ol>
<p><strong>Nota:</strong> Dado que estamos tratando con variables continuas, la probabilidad de que $ X $ tome un valor específico es, en teoría, cero. Es decir, $ P(X = x) = 0 $ para cualquier $ x $. En su lugar, trabajamos con probabilidades en intervalos, como se indicó anteriormente.</p>
</section>
<section id="pmfs-y-pdfs-frecuentemente-usadas" class="level3">
<h3 class="anchored" data-anchor-id="pmfs-y-pdfs-frecuentemente-usadas">PMFs y PDFs frecuentemente usadas</h3>
<p>Las PMFs más usadas son:</p>
<ol type="1">
<li><strong>Bernoulli</strong>: <span class="math inline">\(p(x) = \begin{cases} 1-p &amp; \text{si } x=0 \\ p &amp; \text{si } x=1 \end{cases}\)</span></li>
<li><strong>Binomial</strong>: <span class="math inline">\(p(x) = \binom{n}{x}p^x(1-p)^{n-x}\)</span></li>
<li><strong>Poisson</strong>: <span class="math inline">\(p(x) = \frac{\lambda^x}{x!}e^{-\lambda}\)</span></li>
<li><strong>Geométrica</strong>: <span class="math inline">\(p(x) = (1-p)^{x-1}p\)</span></li>
</ol>
<p>La distribución de Bernoulli es un caso especial de la distribución binomial, cuando <span class="math inline">\(n=1\)</span>.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>image_path <span class="op">=</span> <span class="st">"img/pmf.png"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>display(HTML(<span class="st">'&lt;div style="text-align: center;"&gt;&lt;img src="</span><span class="sc">{}</span><span class="st">" width="60%"/&gt;&lt;/div&gt;'</span>.<span class="bu">format</span>(image_path)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div style="text-align: center;"><img src="img/pmf.png" width="60%"></div>
</div>
</div>
<p>Las PDFs más usadas son:</p>
<ol type="1">
<li><strong>Uniforme</strong>: <span class="math inline">\(f(x) = \begin{cases} \frac{1}{b-a} &amp; \text{si } a \leq x \leq b \\ 0 &amp; \text{en otro caso} \end{cases}\)</span></li>
<li><strong>Normal</strong>: <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}\)</span></li>
<li><strong>Exponencial</strong>: <span class="math inline">\(f(x) = \begin{cases} \lambda e^{-\lambda x} &amp; \text{si } x \geq 0 \\ 0 &amp; \text{si } x &lt; 0 \end{cases}\)</span></li>
</ol>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>image_path <span class="op">=</span> <span class="st">"img/pdfs.png"</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>display(HTML(<span class="st">'&lt;div style="text-align: center;"&gt;&lt;img src="</span><span class="sc">{}</span><span class="st">" width="60%"/&gt;&lt;/div&gt;'</span>.<span class="bu">format</span>(image_path)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div style="text-align: center;"><img src="img/pdfs.png" width="60%"></div>
</div>
</div>
</section>
<section id="distribución-acumulada-cdf" class="level3">
<h3 class="anchored" data-anchor-id="distribución-acumulada-cdf">Distribución acumulada (cdf)</h3>
<p>La CDF es estrictamente creciente, y tiene límites 0 y 1.</p>
<p>Sea <span class="math inline">\(A = (X \leq a)\)</span>, <span class="math inline">\(B = (X \leq b)\)</span> y <span class="math inline">\(C = (a &lt; X \leq b)\)</span> en donde <span class="math inline">\(a &lt; b\)</span>. Tenemos que <span class="math inline">\(B\)</span> es la unión de <span class="math inline">\(A\)</span> y <span class="math inline">\(C\)</span>, es decir, <span class="math inline">\(B\)</span> toma todos los valores que toman <span class="math inline">\(A\)</span> y <span class="math inline">\(C\)</span>. Dado que <span class="math inline">\(A\)</span> y <span class="math inline">\(C\)</span> son mutuamente excluyentes, la probabilidad de <span class="math inline">\(B\)</span> es</p>
<p><span class="math display">\[\text{Pr}(B) = \text{Pr}(A) + \text{Pr}(C) \tag{7} \]</span></p>
<p>Y la probabilidad de estar en el intervalo <span class="math inline">\(C\)</span> como</p>
<p><span class="math display">\[
  \text{Pr}(C) = \text{Pr}(B) - \text{Pr}(A) \tag{8}
\]</span></p>
<p>Definimos la distribución de probabilidad acumulada como</p>
<p><span class="math display">\[
   P(x) \overset{\Delta}{=} \text{Pr}(X \leq x)
\]</span></p>
<p>Con esto, podemos calcular la probabilidad de estar en un intervalo como</p>
<p><span class="math display">\[
  \text{Pr}(a &lt; X \leq b) = P(b) - P(a) \tag{9}
\]</span></p>
<p>La cdf gráficamente tiene esta forma, cuyo eje Y se lee “probabilidad de que <span class="math inline">\(X\)</span> tome valores igual o menor a <span class="math inline">\(x\)</span>”. Notar que esto es una suma acumulada (o integral) que termina en 1.</p>
</section>
<section id="cdf-para-variables-discretas" class="level3">
<h3 class="anchored" data-anchor-id="cdf-para-variables-discretas">CDF para Variables Discretas</h3>
<p><strong>Definición:</strong> Para una variable aleatoria discreta <span class="math inline">\(X\)</span>, la Función de Distribución Acumulativa <span class="math inline">\(F(x)\)</span> es la probabilidad de que <span class="math inline">\(X\)</span> tome un valor menor o igual a <span class="math inline">\(x\)</span>. La CDF es una función escalonada, ya que aumenta solo en los puntos donde la función de masa de probabilidad (PMF) es positiva.</p>
<p><strong>Matemáticamente:</strong> <span class="math display">\[ F(x) = P(X \leq x) = \sum\_{k \leq x} P(X = k) \]</span></p>
<p>Dónde:</p>
<ul>
<li>La suma se extiende sobre todos los valores de <span class="math inline">\(k\)</span> que son menores o iguales a <span class="math inline">\(x\)</span>.</li>
<li><span class="math inline">\(F(x)\)</span> es una función escalonada, ya que aumenta solo en los puntos donde la función de masa de probabilidad (PMF) es positiva.</li>
</ul>
<p><strong>Interpretación:</strong> Si tienes una variable aleatoria discreta que representa, por ejemplo, el número de veces que un evento ocurre, la CDF en un punto específico <span class="math inline">\(x\)</span> te dice la probabilidad acumulada de que ese evento ocurra (x) o menos veces.</p>
</section>
<section id="cdf-para-variables-continuas" class="level3">
<h3 class="anchored" data-anchor-id="cdf-para-variables-continuas">CDF para Variables Continuas</h3>
<p><strong>Definición:</strong> Para una variable aleatoria continua <span class="math inline">\(X\)</span>, la Función de Distribución Acumulativa <span class="math inline">\(F(x)\)</span> es la probabilidad de que <span class="math inline">\(X\)</span> tome un valor menor o igual a <span class="math inline">\(x\)</span>.</p>
<p><strong>Matemáticamente:</strong> <span class="math display">\[ F(x) = P(X \leq x) = \int\_{-\infty}^{x} f(t) \, dt \]</span></p>
<p>Dónde:</p>
<ul>
<li><span class="math inline">\(f(t)\)</span> es la función de densidad de probabilidad (PDF) de <span class="math inline">\(X\)</span>.</li>
<li><span class="math inline">\(F(x)\)</span> es una función continua y no disminuyente.</li>
</ul>
<p><strong>Interpretación:</strong> Si tienes una variable aleatoria continua, como la altura de las personas en una población, la CDF en un punto específico <span class="math inline">\(x\)</span> te dice la probabilidad acumulada de que una persona seleccionada al azar tenga una altura de <span class="math inline">\(x\)</span> o menos.</p>
<p>Para ambas variables, discretas y continuas, la CDF siempre satisface:</p>
<ol type="1">
<li><span class="math inline">\(0 \leq F(x) \leq 1\)</span></li>
<li><span class="math inline">\(F(-\infty) = 0\)</span> y <span class="math inline">\(F(\infty) = 1\)</span></li>
<li><span class="math inline">\(F(x)\)</span> es no decreciente, es decir, si <span class="math inline">\(a &lt; b\)</span>, entonces <span class="math inline">\(F(a) \leq F(b)\)</span>.</li>
</ol>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting up plot dimensions</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">3</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF Gaussiana (Normal)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">101</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> norm.pdf(x, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># CDF Gaussiana</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>y_cdf <span class="op">=</span> norm.cdf(x, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, y_cdf, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'cdf gaussiana'</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="vs">r"$Pr(X \leq x)$"</span>)<span class="op">;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># CDF para la distribución de Poisson</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF Poisson</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> poisson.pmf(x, <span class="dv">5</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># CDF Poisson</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>y_cdf <span class="op">=</span> poisson.cdf(x, <span class="dv">5</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].step(x, y_cdf, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].scatter(x, y_cdf, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'cdf poisson'</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="vs">r"$Pr(X \leq x)$"</span>)<span class="op">;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.1_funciones_distribucion_densidad_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Relación entre función de densidad y función de distribución acumulativa</strong></p>
<p>Podemos definir la función de densidad de probabilidad, o <em>pdf</em>, como la derivada de la cdf</p>
<p><span class="math display">\[
  p(x) \overset{\Delta}{=} \frac{d}{dx}P(x)
\]</span></p>
<p>Alternativamente, en vez de <span class="math inline">\(p(x)\)</span> y <span class="math inline">\(P(x)\)</span> se suele usar, para VA continuas, <span class="math inline">\(f(x)\)</span> y <span class="math inline">\(F(x)\)</span> respectivamente.</p>
<p>Y viceversa: la cdf como la integral de la pdf. Dada la pdf, podemos calcular la probabilidad de una variable continua en un intervalo finito como sigue</p>
<p><span class="math display">\[
  \text{Pr}(a &lt;X\leq b) = \int_a^b p(x)dx = P(b) - P(a) \tag{10}
\]</span></p>
<p>La función de densidad de probabilidad debe satisfacer</p>
<p><span class="math display">\[\begin{align*}
1)\ &amp;f(x) \geq 0,\ \text{para toda } x,\ -\infty &lt; x &lt; \infty\\
2)\ &amp;\int\_{-\infty}^\infty f(x)\text{d}x = 1
\end{align*}\]</span></p>
<hr>
<p><strong>Ejemplo con distribución normal</strong></p>
<p>La pdf de una normal está dada por</p>
<p><span class="math display">\[
  \mathcal{N}(x\mid \mu, \sigma^2)=  p(x) = \frac{1}{\sigma \sqrt{2\pi}} e\left\{\frac{-(x-\mu)^2}{2\sigma^2}\right\} \tag{10}
\]</span></p>
<p>que es gobernada (es decir, su forma y sus valores quedan completamente especificados) por <span class="math inline">\(\mu\)</span>, la media o el valor central, y <span class="math inline">\(\sigma^2\)</span>, llamada la varianza (cuya raíz cuadrada es la desviación estándar <span class="math inline">\(\sigma\)</span>, y está en las unidades de <span class="math inline">\(x\)</span> y <span class="math inline">\(\mu\)</span>).El recíproco de la varianza es llamado <em>precisión</em>, <span class="math inline">\(\tau=1/\sigma^2\)</span>.</p>
<p>En la ecuación (10), el término <span class="math inline">\(\frac{1}{\sigma \sqrt{2\pi}}\)</span> es una constante de <em>normalización</em>, que asegura que <span class="math inline">\(p(x)\)</span> sume 1, por lo que</p>
<p><span class="math display">\[
  \int_{-\infty}^\infty p(x)\text{d}x=1
\]</span></p>
<p>Las siguientes expresiones se cumplen en (10). El valor esperado de <span class="math inline">\(x\)</span> es</p>
<p><span class="math display">\[
  \mathbf{E}[x]=\int_{-\infty}^\infty p(x)x\text{d}x=\mu
\]</span></p>
<p>Y el valor esperado de <span class="math inline">\(x^2\)</span></p>
<p><span class="math display">\[
  \mathbf{E}[x^2] =  \int_{-\infty}^\infty p(x)x\text{d}x^2=\mu^2 + \sigma^2
\]</span></p>
<p>La varianza está dada por <span class="math inline">\(\text{var}[x]=\mathbf{E}[x^2] - \mathbf{E}[x]^2\)</span>, por lo que <span class="math inline">\(\text{var}[x]=\sigma^2\)</span>.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.normal(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">10000</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.mean())</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean(x<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> np.mean(x)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.var(x))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.std(x).<span class="bu">round</span>(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.9881330919624323
9.149508765663048
9.149508765663052
3.02</code></pre>
</div>
</div>
<p>En la siguiente figura a la izquierda se representa una variable aleatoria normal con media 0 y desviación estándar de 1, conocida como distribución normal estándar, y representada como <span class="math inline">\(\mathcal{N}(\mu=0, \sigma = 1)\)</span> o simplemente <span class="math inline">\(\mathcal{N}(0, 1)\)</span>. Para la densidad de probabilidad normal, en Python usamos <code>scipy.stats.norm.pdf(x, loc=0, scale=1)</code>, que nos retorna la densidad en <code>x</code>. <code>norm.</code>, que nos retorna la densidad en <code>x</code>.</p>
<p>A la derecha se representa el área equivalente en la cdf, usando <code>scipy.stats.norm.cdf(x, loc=0, scale=1)</code>.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting up plot dimensions</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">4</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF Gaussiana (Normal)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">101</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> norm.pdf(x, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, y, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'pdf gaussiana (normal)'</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'p(x)'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>from_x, to_x <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>sx <span class="op">=</span> np.concatenate([[from_x], np.arange(from_x, to_x, <span class="fl">0.01</span>), [to_x]])</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>sy <span class="op">=</span> np.concatenate([[<span class="dv">0</span>], norm.pdf(np.arange(from_x, to_x, <span class="fl">0.01</span>)), [<span class="dv">0</span>]])</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].fill(sx, sy, color<span class="op">=</span><span class="st">'#B3B3FF'</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].text(<span class="op">-</span><span class="dv">1</span>, norm.pdf(<span class="dv">0</span>, <span class="dv">0</span>) <span class="op">/</span> <span class="dv">2</span>, <span class="vs">r"$\int_{-1,5}^</span><span class="sc">{1.5}</span><span class="vs"> p(x) dx$"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].text(<span class="op">-</span><span class="dv">1</span>, norm.pdf(<span class="dv">0</span>, <span class="dv">0</span>) <span class="op">/</span> <span class="dv">3</span>, <span class="st">"= P(1.5) - P(-1.5)"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># CDF Gaussiana</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>y_cdf <span class="op">=</span> norm.cdf(x, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, y_cdf, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'cdf gaussiana'</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="vs">r"$Pr(X \leq x)$"</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>sy_cdf <span class="op">=</span> np.concatenate([[<span class="dv">0</span>], norm.cdf(np.arange(from_x, to_x, <span class="fl">0.01</span>)), [<span class="dv">0</span>]])</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].fill_between(sx, sy_cdf, color<span class="op">=</span><span class="st">'#B3B3FF'</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.1_funciones_distribucion_densidad_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>En <code>Python</code>, la función de densidad acumulada CDF para la distribución normal se obtiene con <code>pnorm(x, mean, sd)</code> <code>norm.cdf(x, mean, sd)</code> en donde <code>x</code> es un vector de <em>cuantiles</em>, que es el, o los, valores en <span class="math inline">\(x\)</span> para el cual(es) deseamos obtener su probabilidad (básicamente, un cuantil es la función inversa de <span class="math inline">\(P(x)\)</span>).</p>
<p>Para obtener el área sombreada en la anterior figura, usamos <code>norm.cdf(b)-norm.cdf(a)</code></p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>norm.cdf(<span class="fl">1.5</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">-</span> norm.cdf(<span class="op">-</span><span class="fl">1.5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>0.8663855974622838</code></pre>
</div>
</div>
<p>El área que cubre <code>pnorm(1.5)</code> va desde <span class="math inline">\(-\infty\)</span> a 1.5, y el área de <code>pnorm(-1.5)</code> va de <span class="math inline">\(-\infty\)</span> a -1.5. Matemáticamente, lo anterior se expresaría como</p>
<p><span class="math display">\[
  P(-1.5 &lt; X &lt; 1.5) = \int_{-1.5}^{1.5}\frac{1}{\sigma \sqrt{2\pi}} e\left\{\frac{-(x-\mu)^2}{2\sigma^2}\right\}\text{d}x
\]</span></p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Rectangle</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_normal_distribution(mean<span class="op">=</span><span class="dv">0</span>, std_dev<span class="op">=</span><span class="dv">1</span>, lower_limit<span class="op">=-</span><span class="dv">1</span>, upper_limit<span class="op">=</span><span class="dv">1</span>, c<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Setting up plot dimensions</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">4</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PDF of Gaussian (Normal)</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(mean <span class="op">-</span> <span class="dv">4</span><span class="op">*</span>std_dev, mean <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>std_dev, <span class="dv">101</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> norm.pdf(x, mean, std_dev)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(x, y, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'PDF'</span> <span class="op">+</span> <span class="ss">f'$ \mu \pm </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">\sigma $'</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_ylabel(<span class="st">'p(x)'</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    sx <span class="op">=</span> np.concatenate([[lower_limit], np.arange(lower_limit, upper_limit, <span class="fl">0.01</span>), [upper_limit]])</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    sy <span class="op">=</span> np.concatenate([[<span class="dv">0</span>], norm.pdf(np.arange(lower_limit, upper_limit, <span class="fl">0.01</span>), mean, std_dev), [<span class="dv">0</span>]])</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].fill(sx, sy, color<span class="op">=</span><span class="st">'#B3B3FF'</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    percentage <span class="op">=</span> (norm.cdf(upper_limit, mean, std_dev) <span class="op">-</span> norm.cdf(lower_limit, mean, std_dev)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].text((lower_limit <span class="op">+</span> upper_limit) <span class="op">/</span> <span class="dv">2</span>, norm.pdf(mean, mean, std_dev) <span class="op">/</span> <span class="dv">2</span>, <span class="ss">f"</span><span class="sc">{</span>percentage<span class="sc">:.2f}</span><span class="ss">%"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    annotation_points <span class="op">=</span> [mean, mean<span class="op">-</span>std_dev, mean<span class="op">-</span><span class="dv">2</span><span class="op">*</span>std_dev, mean<span class="op">+</span>std_dev, mean<span class="op">+</span><span class="dv">2</span><span class="op">*</span>std_dev]</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    annotation_labels <span class="op">=</span> [<span class="vs">r'$\mu$'</span>, <span class="vs">r'$\mu-\sigma$'</span>, <span class="vs">r'$\mu-2\sigma$'</span>, <span class="vs">r'$\mu+\sigma$'</span>, <span class="vs">r'$\mu+2\sigma$'</span>]</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    annotation_y_offset_points <span class="op">=</span> <span class="op">-</span><span class="dv">7</span>  <span class="co"># The y-offset for the annotation in points</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    annotation_y_offset_data_coords <span class="op">=</span> annotation_y_offset_points <span class="op">/</span> axes[<span class="dv">0</span>].figure.bbox.height <span class="op">*</span> (axes[<span class="dv">0</span>].get_ylim()[<span class="dv">1</span>] <span class="op">-</span> axes[<span class="dv">0</span>].get_ylim()[<span class="dv">0</span>])</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    annotation_y_data_coords <span class="op">=</span> y.<span class="bu">min</span>() <span class="op">+</span> annotation_y_offset_data_coords</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a single gray rectangle at the y-coordinate of the annotation</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    rect_height <span class="op">=</span> <span class="fl">0.013</span>  <span class="co"># Height of the rectangle</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> Rectangle((x.<span class="bu">min</span>(), annotation_y_data_coords <span class="op">-</span> rect_height <span class="op">/</span> <span class="fl">1.4</span>), </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>                    x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>(), rect_height, </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>                    linewidth<span class="op">=</span><span class="dv">1</span>, edgecolor<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>                    facecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].add_patch(rect)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Annotate points on top of the gray rectangle</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> point, label <span class="kw">in</span> <span class="bu">zip</span>(annotation_points, annotation_labels):</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].annotate(label, xy<span class="op">=</span>(point, annotation_y_data_coords), </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>                        xycoords<span class="op">=</span><span class="st">'data'</span>, </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>                        color<span class="op">=</span><span class="st">'#FF8080'</span>,</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>                        textcoords<span class="op">=</span><span class="st">'offset points'</span>, </span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>                        xytext<span class="op">=</span>(<span class="dv">0</span>, annotation_y_offset_points<span class="op">+</span><span class="dv">3</span>), ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CDF of Gaussian</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    y_cdf <span class="op">=</span> norm.cdf(x, mean, std_dev)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(x, y_cdf, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'CDF,'</span> <span class="op">+</span> <span class="ss">f'$ \mu \pm </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">\sigma $'</span>)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_ylabel(<span class="vs">r"$Pr(X \leq x)$"</span>)</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    sy_cdf <span class="op">=</span> np.concatenate([[<span class="dv">0</span>], norm.cdf(np.arange(lower_limit, upper_limit, <span class="fl">0.01</span>), mean, std_dev), [<span class="dv">0</span>]])</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].fill_between(sx, sy_cdf, color<span class="op">=</span><span class="st">'#B3B3FF'</span>)</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].text((lower_limit <span class="op">+</span> upper_limit) <span class="op">/</span> <span class="dv">2</span>, </span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>                 (norm.cdf(lower_limit, mean, std_dev) <span class="op">+</span> norm.cdf(upper_limit, mean, std_dev)) <span class="op">/</span> <span class="dv">4</span>, </span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>                 <span class="ss">f"</span><span class="sc">{</span>percentage<span class="sc">:.2f}</span><span class="ss">%"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    annotation_y_offset_data_coords <span class="op">=</span> annotation_y_offset_points <span class="op">/</span> axes[<span class="dv">1</span>].figure.bbox.height <span class="op">*</span> (axes[<span class="dv">1</span>].get_ylim()[<span class="dv">1</span>] <span class="op">-</span> axes[<span class="dv">1</span>].get_ylim()[<span class="dv">0</span>])</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    annotation_y_data_coords <span class="op">=</span> y_cdf.<span class="bu">min</span>() <span class="op">+</span> annotation_y_offset_data_coords</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a single gray rectangle at the y-coordinate of the annotation</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    rect_height <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Height of the rectangle</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> Rectangle((x.<span class="bu">min</span>(), annotation_y_data_coords <span class="op">-</span> rect_height <span class="op">/</span> <span class="fl">1.4</span>), </span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>                    x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>(), rect_height, </span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>                    linewidth<span class="op">=</span><span class="dv">1</span>, edgecolor<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>                    facecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].add_patch(rect)</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Annotate points on top of the gray rectangle</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> point, label <span class="kw">in</span> <span class="bu">zip</span>(annotation_points, annotation_labels):</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>].annotate(label, xy<span class="op">=</span>(point, annotation_y_data_coords), </span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>                        xycoords<span class="op">=</span><span class="st">'data'</span>, </span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>                        color<span class="op">=</span><span class="st">'#FF8080'</span>,</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>                        textcoords<span class="op">=</span><span class="st">'offset points'</span>, </span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>                        xytext<span class="op">=</span>(<span class="dv">0</span>, annotation_y_offset_points<span class="op">+</span><span class="dv">3</span>), ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>const <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> const:</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    plot_normal_distribution(mean<span class="op">=</span>mu, std_dev<span class="op">=</span>sigma, lower_limit<span class="op">=</span>mu<span class="op">-</span>c<span class="op">*</span>sigma, upper_limit<span class="op">=</span>mu<span class="op">+</span>c<span class="op">*</span>sigma, c<span class="op">=</span>c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.1_funciones_distribucion_densidad_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.1_funciones_distribucion_densidad_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.1_funciones_distribucion_densidad_files/figure-html/cell-15-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>En contraste con las <strong>VA</strong> discretas, la probabilidad de que una variable continua <span class="math inline">\(X\in \mathbb{R}\)</span> tome un valor particular, <span class="math inline">\(p(X = x)\)</span>, es 0. Es como integrar la función de densidad de la siguiente manera:</p>
<p><span class="math display">\[
  Pr(a \leq X \leq a) = \int_a^b f(x)dx = P(a) - P(a)
\]</span></p>
<p>Por esta razón, con <span class="math inline">\(\text{\sf pdf}\)</span> solo calculamos probabilidades en intervalos.</p>
<hr>
<p>Para VA continuas, las reglas de suma y producto son</p>
<p><span class="math display">\[\begin{align*}
\text{ \bf{regla de la suma}} \quad\quad &amp;f(x) = \int_y f(x,y)\text{d}y \\
\text{ \bf{regla del producto}}\quad\quad &amp;f(x, y) = f(y|x)f(x)
\end{align*}\]</span></p>
<p>En donde <span class="math inline">\(f(x)\)</span> es la función de probabilidad marginal, y se integra <em>con respecto a</em> <span class="math inline">\(y\)</span>. Lo mismo si queremos encontrar la marginal de <span class="math inline">\(y\)</span> tenemos que integrar <span class="math inline">\(f(x,y)\)</span> <em>con respecto a</em> <span class="math inline">\(x\)</span>.</p>
</section>
</section>
<section id="función-acumulada-de-probabilidad-conjunta" class="level2">
<h2 class="anchored" data-anchor-id="función-acumulada-de-probabilidad-conjunta">Función acumulada de probabilidad conjunta</h2>
<p>Sean <span class="math inline">\(X_1, X_2\)</span> variables aleatorias continuas con función de distribución conjunta <span class="math inline">\(F(x_1, x_2)\)</span>. La función de distribución bivariante <span class="math inline">\(F(x_1, x_2)\)</span> es</p>
<p><span class="math display">\[
  F(x_1, x_2) = P(X_1 \leq x_1, X_2 \leq x_2),\quad -\infty &lt; x_1 &lt; \infty, -\infty &lt; x_2&lt;\infty
\]</span></p>
<p>Si existe una función no negativa <span class="math inline">\(f(x_1, x_2)\)</span>, se obtiene</p>
<p><span class="math display">\[\begin{align*}
F(x_1, x_2) = \int*{-\infty}^{x_2} \int_{-\infty}^{x_1} f(t_1, t_2)\text{d}t_1\text{d}t_2
\end{align*}\]</span></p>
<p>Para toda <span class="math inline">\(-\infty &lt; x_1&lt;\infty, -\infty &lt; x_2&lt;\infty\)</span>. En donde <span class="math inline">\(t_1, t_2\)</span> son solo variables de integración.</p>
<p>Satisfacen</p>
<p><span class="math display">\[\begin{align*}
1. &amp;f(x_1, x_2)\geq 0\quad \text{para toda }x_1, x_2\\
2. &amp;\int_{-\infty}^\infty f(x_1, x_2) \text{d}x_1\text{d}x_2= 1
\end{align*}\]</span></p>
<p><strong>Ejemplos</strong></p>
<ol type="1">
<li>Dada <span class="math inline">\(f(y) = cy^2,\ 0 \leq y \leq 2\)</span> y <span class="math inline">\(f(y)=0\)</span> en cualquier otra parte, encuentre el valor de <span class="math inline">\(c\)</span> para el cuál <span class="math inline">\(f(y)\)</span> es una función de densidad válida.</li>
</ol>
<blockquote class="blockquote">
<p><em>Solución</em></p>
</blockquote>
<blockquote class="blockquote">
<p>Para obtener <span class="math inline">\(c\)</span>, requerimos un valor tal que se cumpla</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math display">\[
F(y) = \int_{-\infty}^\infty f(y)\text{d}y = 1
\]</span></p>
<p>Lo que nos da</p>
<p><span class="math display">\[
F(y) = \int_0^2 cy^2\text{d}y=\frac{cy^3}{3} \Bigg|_0^2=\frac{8}{3}c
\]</span></p>
<p>Sustituyendo <span class="math inline">\(\frac{8}{3}c=1\)</span> nos da que <span class="math inline">\(c=3/8\)</span>.</p>
</blockquote>
<ol start="2" type="1">
<li>Encontrar <span class="math inline">\(P(1\leq Y \leq 2)\)</span> para la función del ejemplo 1, también encontrar <span class="math inline">\(P(1&lt; Y &lt; 2)\)</span></li>
</ol>
<blockquote class="blockquote">
<p><em>Solución</em></p>
</blockquote>
<blockquote class="blockquote">
<p>Dado que ya encontramos el valor de que satisface <span class="math inline">\(F(y) = \int_{-\infty}^\infty f(y)\text{d}y = 1\)</span>, la sustituimos.</p>
<p><span class="math display">\[
P(1\leq Y \leq 2) = \int_1^2 f(y)\text{d}y= \frac{3}{8}\int_1^2 y^2\text{d}y=7/8
\]</span></p>
</blockquote>
<ol start="3" type="1">
<li>Como una medida de inteligencia, a unos ratones se les toma el tiempo que tardan para pasar por un laberinto para llegar a una recompensa (alimento). El tiempo en segundos necesario para cualquier ratón es una variable aleatoria <span class="math inline">\(Y\)</span> con función de densidad dada por</li>
</ol>
<p><span class="math display">\[
  f(y) = \begin{cases}
    \frac{b}{y^2},\ &amp;y\geq b\\
    0,\ &amp;\text{en cualquier otro punto}
  \end{cases}
\]</span></p>
<p>En donde <span class="math inline">\(b\)</span> es el tiempo mínimo posible para recorrer el laberinto. Demostrar que <span class="math inline">\(f(y)\)</span> tiene las propiedades de una función de densidad.</p>
<blockquote class="blockquote">
<p><em>Solución</em></p>
</blockquote>
<blockquote class="blockquote">
<p>Dado que <span class="math inline">\(b\)</span> es un tiempo, no puede ser negativo. Además, <span class="math inline">\(f(y)\)</span> tiene el término cuadrático <span class="math inline">\(y^2\)</span>, que tampoco puede ser negativo, por lo que <span class="math inline">\(f(y) \geq 0\)</span>.</p>
<p>El mínimo valor que puede tener <span class="math inline">\(y\)</span> es <span class="math inline">\(b\)</span>. Por lo tanto</p>
<p><span class="math display">\[\begin{align*}
F(y) &amp;= \int_{b}^\infty \frac{b}{y^2}\text{d}y= 1\\  
&amp;= \frac{by^{-2+1}}{-2+1}\Bigg|_b^\infty=-\frac{b}{y}\Bigg|_b^\infty=0-\left(-\frac{b}{b}\right)=1
\end{align*}\]</span></p>
</blockquote>
<ol start="4" type="1">
<li>En el ejemplo 1 determinamos que <span class="math inline">\(f(y)=(3/8)y^2\)</span> para <span class="math inline">\(0\leq y \leq 2, f(y)=0\)</span> en cualquier otra parte. Si la variable <span class="math inline">\(Y\)</span> tiene esta función de densidad, encontrar <span class="math inline">\(\mu=\mathbf{E}[Y], \sigma^2=\text{var}[Y]\)</span>, recordando que <span class="math inline">\(\text{var}[x]=\mathbf{E}[x^2]-(\mathbf{E}[x])^2\)</span>.</li>
</ol>
<blockquote class="blockquote">
<p><em>Solución</em></p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math display">\[\begin{align*}
\mathbf{E}[Y] &amp;= \int_{-\infty}^\infty yf(y)\text{d}y= \int_{-\infty}^\infty y\frac{3y^2}{8}\text{d}y = \frac{3}{8}\cdot\frac{1}{4}y^4 \Bigg|_0^2=1.5\\
\text{para } &amp;\mathbf{E}[Y^2]\quad \text{se obtiene}\\
\mathbf{E}[Y^2] &amp;= \int_{-\infty}^\infty y^2f(y)\text{d}y= \int_{-\infty}^\infty y^2\frac{3y^2}{8}\text{d}y = \frac{3}{8}\cdot\frac{1}{5}y^5 \Bigg|_0^2=2.4\\
\text{por }&amp;\text{lo que}\\
\text{var}[x]&amp;=\mathbf{E}[x^2]-(\mathbf{E}[x])^2 = 2.4 - 1.5^2 = 0.15
\end{align*}\]</span></p>
</blockquote>
<ol start="5" type="1">
<li>Una partícula radiactiva se localiza en un cuadrado con lados de longitud 1. Denotar como <span class="math inline">\(Y_1, Y_2\)</span> las coordenadas de la ubicación de la partícula. Un modelo razonable para el histograma de frecuencia relativa para <span class="math inline">\(Y_1, Y_2\)</span> es la función bivariante de densidad</li>
</ol>
<p><span class="math display">\[
  f(y_1, y_2) = \begin{cases}
  1,\quad &amp; 0 \leq y_1 \leq 1, 0 \leq y_2 \leq 1\\
  0, \quad &amp; \text{en cualquier otro punto}
  \end{cases}
\]</span></p>
<p>Econtrar <span class="math inline">\(F(y_1=0.2, y_2=0.4)\)</span>, que es lo mismo que encontrar la probabilidad <span class="math inline">\(P(y_1&lt;0.2, y_2&lt;0.4)\)</span>.</p>
<blockquote class="blockquote">
<p><em>Solución</em></p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math display">\[\begin{align}
F(y*1=0.2, y_2=0.4)%
&amp;= \int_{-\infty}^{0.4} \int_{-\infty}^{0.2} f(y_1, y_2)\text{d}y_1\text{d}y_2 \\
&amp;= \int_{-\infty}^{0.4} \int_{-\infty}^{0.2} (1)\text{d}y_1\text{d}y_2 \\
&amp;= \int_{-\infty}^{0.4} \left(\int_{-\infty}^{0.2} \text{d}y_1\right)\text{d}y_2\\
&amp;= \int_{-\infty}^{0.4} \Bigg( y_1\Big|_0^{0.2} \Bigg)\text{d}y_2\\
&amp;= \int_{-\infty}^{0.4} 0.2 \text{d}y_2 = 0.2y_2\Big|_0^{0.4} = 0.08
\end{align}\]</span></p>
</blockquote>
<ol start="6" type="1">
<li>Sea</li>
</ol>
<hr>
<p><span class="math display">\[
  f(y_1, y_2) = \begin{cases}
    2y_1\quad 0 \leq y_1 \leq, 0 \leq y_2 \leq\\
    0,\quad \text{en otro punto}
  \end{cases}
\]</span></p>
<ol type="a">
<li>Obtener las funciones de densidad marginal <span class="math inline">\(f(y_1)\)</span> y <span class="math inline">\(f(y_2)\)</span>.</li>
<li>Obtener la función condicional <span class="math inline">\(f(y_1 | y_2)\)</span></li>
<li>Demostrar si las variables <span class="math inline">\(Y_1, Y_2\)</span> son independientes.</li>
</ol>
<blockquote class="blockquote">
<p><em>Solución</em></p>
</blockquote>
<blockquote class="blockquote">
<ol type="a">
<li>La marginal de <span class="math inline">\(f(y_1)\)</span> se obtiene aplicando la regla</li>
</ol>
<p><span class="math display">\[
f(x) = \int_{-\infty}^\infty f(x, y)\text{d}y
\]</span></p>
<p>Notar que para obtener la marginal de la variable <span class="math inline">\(x\)</span> se integra la función conjunta con respecto a <span class="math inline">\(y\)</span>. Esto significa que trataremos a <span class="math inline">\(x\)</span> como <em>constante</em>. En este caso, como tenemos <span class="math inline">\(y_1, y_2\)</span> en vez de <span class="math inline">\(x, y\)</span>, la marginal sería</p>
<p><span class="math display">\[
f(y_1)= \int_{-\infty}^\infty f(y_1, y_2)\text{d}y_2=\int_{0}^12y_1\text{d}y_2
\]</span></p>
<p>Y trataremos a <span class="math inline">\(y_1\)</span> como constante, y usamos la regla <span class="math inline">\(\int \text{d}x=x\)</span></p>
<p><span class="math display">\[
f(y_1)=\int_{0}^12y_1\text{d}y_2=2y_1\int_{0}^1\text{d}y_2=2y_1\left(y_2\Big|_0^1\right)=2y_1
\]</span></p>
<p>Para <span class="math inline">\(f(y_2)\)</span> seguimos un razonamiento similar.</p>
<p><span class="math display">\[
f(y_2)= \int_{-\infty}^\infty f(y_1, y_2)\text{d}y_1=\int_{0}^12y_1\text{d}y_1
\]</span></p>
<p>Pero ahora integramos con respecto a <span class="math inline">\(y_1\)</span>. Aplicamos la regla <span class="math inline">\(\int x^n \text{d}x=\frac{x^{n+1}}{n+1}\)</span></p>
<p><span class="math display">\[
f(y_2)=\int_{0}^12y_1\text{d}y_1=2\frac{y_1^2}{2}\Big|_0^1=y_1^2\Big|_0^1=1
\]</span></p>
<p>La marginal de <span class="math inline">\(y_2\)</span> es una constante. b) La función condicional se puede obtener con la siguiente regla</p>
<p><span class="math display">\[
f(x|y) = \frac{f(x, y)}{f(x)}
\]</span></p>
<p>Por lo que para obtener <span class="math inline">\(f(y_1|y_2)\)</span> necesitamos la densidad conjunta (que ya tenemos), y la marginal de <span class="math inline">\(f(y_2)\)</span>, que ya tenemos también.</p>
<p><span class="math display">\[
f(y_1|y_2) = \frac{f(y_1, y_2)}{f(y_2)} = \frac{2y_1}{1}=2y_1
\]</span></p>
<p>La condicional sigue siendo la conjunta porque la marginal es una constante. c) La demostración de que las variables son independientes es trivial siguiendo la regla: <span class="math inline">\(x,y\)</span> son independientes <em>si y solo si</em> <span class="math inline">\(f(x,y)=f(x)f(y)\)</span></p>
</blockquote>
<ol start="7" type="1">
<li>Sea la función de densidad conjunta</li>
</ol>
<hr>
<p><span class="math display">\[
  f(y_1, y_2) = \begin{cases}
    e^{-(y_1 + y_2)}\quad y_1&gt;0, y_2&gt;0\\
    0,\quad \text{en otro punto}
  \end{cases}
\]</span></p>
<ol type="a">
<li><p>Encontrar <span class="math inline">\(f(y_1)\)</span> y <span class="math inline">\(f(y_2)\)</span>.</p></li>
<li><p>¿Cuál es la probabilidad <span class="math inline">\(P(1 &lt; Y_1 &lt; 2.5)\)</span> y <span class="math inline">\(P(1 &lt; Y_2 &lt; 2.5)\)</span>?</p></li>
<li><p>Para cualquier <span class="math inline">\(Y_2&gt;0\)</span>, ¿cuál es la función <span class="math inline">\(f(y_1|y_2)\)</span>?</p></li>
</ol>
<blockquote class="blockquote">
<p><em>Solución</em></p>
</blockquote>
<blockquote class="blockquote">
<ol type="a">
<li>Primero notar que tanto <span class="math inline">\(y_1\)</span> como <span class="math inline">\(y_2\)</span> están en el intervalo <span class="math inline">\((0, \infty)\)</span>, por lo que esos son sus límites de integración. Formalmente, lo correcto sería encontrar el límite de la integral</li>
</ol>
<p><span class="math display">\[
f(y_1)=\lim_{t\rightarrow \infty}\int_{-\infty}^{\infty}f(y_1,y_2)\text{d}y_2
\]</span></p>
<p>Sin embargo, <em>informalmente</em> sabemos que <span class="math inline">\(e^{-\infty}=0\)</span>. Aplicamos la regla de los exponentes <span class="math inline">\(a^na^m=a^{n+m}\)</span> a <span class="math inline">\(e^{-(y_1+y_2)}=e^{-y_1}e^{-y_2}\)</span></p>
<p><span class="math display">\[
f(y_1)=\int_{-\infty}^{\infty}f(y_1,y_2)\text{d}y_2=\int_0^{\infty}e^{-y_1}e^{-y_2}\text{d}y_2=e^{-y_1}\int_0^{\infty}e^{-y_2}\text{d}y_2
\]</span></p>
<p>Para integrar lo anterior, consideramos la siguiente regla <span class="math inline">\(\int e^{-u}du=-e^{-u}\)</span></p>
<p><span class="math display">\[
f(y_1) = e^{-y_1}\int_0^{\infty}e^{-y_2}\text{d}y_2=e^{-y_1}\left(-e^{-y_2}\Big|_0^\infty\right)=e^{-y_1}\left(-(e^\infty-e^0)\right)=\cdots=e^{-y_1}
\]</span></p>
<p>El mismo razonamiento para <span class="math inline">\(f(y_2)\)</span> nos da un resultado similar</p>
</blockquote>
<p><span class="math display">\[
  f(y_2)=\int_{-0}^{\infty}e^{-(y_1+y_2)}\text{d}y_1=\cdots=e^{-y_2}
\]</span></p>
<blockquote class="blockquote">
<ol start="2" type="a">
<li>Para obtener esta probabilidad (acumulada) necesitamos la regla</li>
</ol>
</blockquote>
<blockquote class="blockquote">
<p><span class="math display">\[
P(a &lt; X &lt; b)=\int_a^b f(x)\text{d}x
\]</span></p>
<p>En donde <span class="math inline">\(f(x)\)</span> en nuestro caso corresponde a las marginales <span class="math inline">\(f(y_1)=e^{-y_1}, f(y_2)=e^{-y_2}\)</span></p>
<p><span class="math display">\[
P(1&lt;Y_1&lt;2.5)=\int_1^{2.5}e^{-y_1}\text{d}y_1=-e^{-y_1}\Big|_1^{2-5}=-\left(e^{-2.5}-e^{-1}\right)=\cdots=0.285
\]</span></p>
<p>Un razonamiento similar aplica para la segunda parte del ejercicio.</p>
</blockquote>
<blockquote class="blockquote">
<ol start="3" type="a">
<li>Usamos la regla del producto ya revisada: <span class="math inline">\(f(x|y)=f(x,y)/f(y)\)</span>. La conjunta es <span class="math inline">\(f(y_1,y_2)=e^{-(y_1+y_2)}=e^{-y_1}e^{-y_2}\)</span> y la marginal <span class="math inline">\(f(y_2)=e^{-y_2}\)</span></li>
</ol>
<p><span class="math display">\[
f(y_1|y_2)=\frac{e^{-y_1}e^{-y_2}}{e^{-y_2}}=e^{-y_1},\quad \text{para todo } y_2&gt;0
\]</span></p>
<p>Un razonamiento similar aplica a <span class="math inline">\(f(y_2|y_2)\)</span>.</p>
</blockquote>
<ol start="8" type="1">
<li>Ejemplo de una normal</li>
</ol>
<p>La temperatura promedio de una máquina es de 37°C, con una desviación estándar medida de 1.5. Suponiendo que la distribución de la temperatura puede ser aproximada por una normal, ¿qué tan probable es encontrar una temperatura de 35 o menos?</p>
<blockquote class="blockquote">
<p><em>Solución</em></p>
</blockquote>
<blockquote class="blockquote">
<p>Queremos hallar la probabilidad <span class="math inline">\(P(X&lt;35)\)</span> sabiendo que <span class="math inline">\(X\sim \mathcal{N}(\mu=37, \sigma=1.5)\)</span>. Es decir</p>
<p><span class="math display">\[
P(X&lt;35)=\int_{0}^{35}\frac{1}{1.5 \sqrt{2\pi}} e\left\{\frac{-(x-37)^2}{2(1.5)^2}\right\}\text{d}x
\]</span></p>
</blockquote>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting up plot dimensions</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">4</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">101</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> norm.pdf(x, <span class="dv">37</span>, <span class="fl">1.5</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, y, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'pdf'</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'p(x)'</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>from_x, to_x <span class="op">=</span> <span class="dv">30</span>, <span class="dv">35</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>sx <span class="op">=</span> np.concatenate([[from_x], np.arange(from_x, to_x, <span class="fl">0.01</span>), [to_x]])</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>sy <span class="op">=</span> np.concatenate([[<span class="dv">0</span>], norm.pdf(np.arange(from_x, to_x, <span class="fl">0.01</span>), <span class="dv">37</span>, <span class="fl">1.5</span>), [<span class="dv">0</span>]])</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].fill(sx, sy, color<span class="op">=</span><span class="st">'#B3B3FF'</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].text(<span class="dv">35</span> <span class="op">+</span> <span class="dv">1</span>, norm.pdf(<span class="dv">35</span>, <span class="dv">37</span>, <span class="fl">1.5</span>), <span class="st">'x=35'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># CDF</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>y_cdf <span class="op">=</span> norm.cdf(x, <span class="dv">37</span>, <span class="fl">1.5</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, y_cdf, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'cdf'</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="vs">r"$Pr(X \leq x)$"</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>sy_cdf <span class="op">=</span> np.concatenate([[<span class="dv">0</span>], norm.cdf(np.arange(from_x, to_x, <span class="fl">0.01</span>), <span class="dv">37</span>, <span class="fl">1.5</span>), [<span class="dv">0</span>]])</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].fill_between(sx, sy_cdf, color<span class="op">=</span><span class="st">'#B3B3FF'</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].text(<span class="dv">35</span> <span class="op">+</span> <span class="dv">1</span>, norm.cdf(<span class="dv">35</span>, <span class="dv">37</span>, <span class="fl">1.5</span>), <span class="st">'x=35'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.1_funciones_distribucion_densidad_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>El área se obtiene en Python con el siguiente código, que usa la cdf normal, <code>pnorm</code>. El primer argumento es el <em>cuantil</em> <code>q</code>, el valor en el eje <em>x</em> del cual queremos saber el área bajo la curva.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>norm.cdf(<span class="dv">35</span>, <span class="dv">37</span>, <span class="fl">1.5</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿cuál sería la probabilidad de tener 37 o menos?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>0.09121121972586788</code></pre>
</div>
</div>
<p>Equivalentemente, en Python se puede integrar la pdf con integración numérica</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> quad</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to integrate</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x, mean, sd):</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> norm.pdf(x, mean, sd)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform numerical integration</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>result, error <span class="op">=</span> quad(f, <span class="dv">0</span>, <span class="dv">35</span>, args<span class="op">=</span>(<span class="dv">37</span>, <span class="fl">1.5</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Result of the integration: </span><span class="sc">{</span>result<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Estimated error: </span><span class="sc">{</span>error<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Result of the integration: 0.09121121972586801
Estimated error: 6.708159657636305e-10</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>